class: center, middle

# Artificial neural networks

.center[
  <img src="./images/TitleSlideImage.png" alt="Title image"
       style="max-width:55%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

**Автор:** Петър Герджиков – Mid-level Software Developer

---

# Programming VS Machine & Deep learning

#### Традиционно програмиране
- Developer пише логика
- Детерминистично – същи входове = същи изходи
- Скалируемост: добра за определени сценарии, лоша при сложност

#### Machine Learning / Deep Learning
- Модел **учи** от примери в данните
- Data-driven подход – правилата се издават автоматично
- Скалируемост: висока за повторяващи се задачи с големи датасети

.center[
  <img src="https://miro.medium.com/1*r9maKiD9n5b_MX8kXAH8aQ.png" alt="Programming vs AI"
       style="max-width:55%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

## Use case-ове на изкуствен интелект от работа

- OCR - Optical character recognition

- NLP - natural language processor

- LLM models, AI agents, etc.

---

# Защо изкуствените невронни мрежи са от интерес в геопространствения анализ?

#### Предизвикателства в традиционния ГИС анализ
- Класификация на сателитни изображения отнема часове ръчна работа
- Извличане на геоспециализация от растери е деликатно и субективно
- Необходимост за различни подходи при различни мащабове и типове данни

#### Как ИНМ решават тези проблеми
- **Автоматизация:** обучен модел класифицира няколко минути вместо часове
- **Обобщение:** един модел може да работи на различни мащабове
- **Точност:** често по-добра от традиционните методи при достатъчни данни

.center[
  <img src="https://a-us.storyblok.com/f/1018982/fd83270896/roof-condition-report-aerial-images.jpg/m/fit-in/1920x0/filters:quality(75)" alt="Programming vs AI"
       style="max-width:55%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# Какво е изкуствена невронна мрежа?

#### Основната идея
- Събираме <span style="color:rgb(255, 0, 0)">много прости един елемент</span> (неврон)
- Всеки неврон получава входове, прилага претегляне и активация
- Когато комбинираме хиляди такива елементи, можем да научим **много сложни** зависимости между входове и изходи

#### Биологична аналогия
- Биологичен неврон получава сигнали (дендрити), обработва ги и изпраща нов сигнал (аксон)
- Изкуствен неврон работи по подобен начин, но с числа вместо електрохимични импулси

<span style="color:rgb(255, 0, 0)">image</span>

---

# Основни елементи на невронната мрежа

#### Основни компоненти
- **Входове (x₁, x₂, ...):** Данни от външния свят (например пиксели от изображение)
- **Тегла (w₁, w₂, ...):** Параметри, които показват "колко важен" е всеки вход. Това е това, което моделът **учи**.
- **Bias (b):** Допълнителен параметър, който позволява гъвкаво изместване на решаващата граница.
- **Активационна функция f():** Прилага се след претегления сбор – позволява нелинейност.

#### Активационни функции (кратко без формули)
- **Sigmoid:** всички стойности между 0 и 1; проблем: малки градиенти при дълбоки мрежи
- **ReLU (Rectified Linear Unit):** Съвременен стандарт; максимум(0, x); бърза за обучение, стабилна

#### Обучение
- **Loss функция:** Измерва "колко лошо" предсказва моделът (сравнява предсказаното с реалното)
- **Gradient descent:** Алгоритъм, който намалява loss функцията чрез коригиране на теглата в правилната посока
- **Backpropagation:** Алгоритъм, който разпределя грешката назад през мрежата, за да се знае как да се променят теглата.

<span style="color:rgb(255, 0, 0)"><b>Изображение:</b> Схема на един неврон с всички компоненти; графика на ReLU vs Sigmoid функции</span>

---

# Feedforward и CNN

#### Feedforward мрежи (напълно свързани слоеве)
- Всеки неврон в един слой е свързан с всеки неврон в следващия слой
- **Подходящи за:** таблични данни, векторни геопространствени атрибути
- **Проблем:** при изображения това означава огромен брой параметри (например 100×100 пиксела = 10,000 входа!)

#### Ограничения при применение на feedforward за изображения
- Огромен брой параметри → медленобучение
- Загубиват се локални пространствени структури (например ръбове, текстури)
- Слабо обобщение при нови данни

#### CNN (Convolutional Neural Networks) – идеята
- Вместо напълно свързани слоеве, използваме **конволюционни слоеве**
- Идеята: използваме малки матрици (kernels), които се движат по изображението
- Това улавя **локални пространствени структури** много по-ефективно
- Намалява брой параметри → по-бързо обучение, по-добра генерализация

#### Защо CNN са перфектни за ГИС
- Растерни данни (сателитни, аерофото) са двумерни структури
- CNN естествено работи с локални зависимости в растерите
- Много по-ефективни от feedforward за този тип данни

- <span style="color:rgb(255, 0, 0)"><b>Изображение:</b> Архитектурна диаграма на CNN (entrada → convolutional слоеве → pooling → fully connected → изход)</span>

---

# CNN в геопространствения анализ

#### Защо CNN се подходят за геопространствени данни
- Растерни формати (GeoTIFF, COG) са природно двумерни матрици
- Локални признаци (текстури, ръбове) са критични за класификация земно покритие
- Модели обучени на един регион могат да работят на други региони

#### Ключови концепции
- **Локални рецептивни полета:** Всеки неврон "вижда" малко окно (например 3×3 пиксела), не цялото изображение
  - Позволява улавяне на текстури (мрежа от дърветата), контрасти (граница град/поле)
  
- **Translation invariance:** Обект (например сграда) в горния ляв ъгъл се разпознава по същия начин, като в центъра
  - **Практично:** при обработка на сателитни сцени, обектите са случайно разположени; CNN го обработва еднакво

- **Йерархия на признаците:** Ранните слоеве улавят прости признаци (ръбове), средните – текстури, дълбоките – цели обекти

#### Примери
- Класификация на сателитни 32×32 px patches в категории: "град", "гора", "вода", "селскостопанска земя"
- Всеки patch го преминава през CNN и получава класа

#### Визуален елемент
- **Изображение:** Пример на сателитна сцена (Sentinel-2, Landsat) с три различни типа земно покритие (град, гора, вода); стрелки показват как CNN обработва локални региони

---

# Какво е семантична сегментация?

#### Определение
- **Семантична сегментация:** За всеки пиксел в изображението предсказваме който му съответства клас
- Резултат: **карта** (растер), при която всеки пиксел има етикет (например "град", "гора", "вода", "селскостопанска земя")

#### Сравнение с други задачи (кратко)
- **Класификация на цялото изображение:** един клас за цялото изображение (например "урбанизирана територия") → не е достатъчно за ГИС
- **Object detection:** предсказва ограничителни правоъгълници (bounding boxes) и класове за отделни обекти (например "сграда в координати X") → полезно, но не дава пикселно разделение
- **Instance segmentation:** разделя пиксели по отделни обекти от един клас (например всяка отделна сграда отделно) → полезно за някои задачи, но сложно
- **Семантична сегментация:** всички пиксели от един клас са един обект, неважи от колко отделни сгради са съставени → идеално за LULC карти

#### Практическото значение
- Традиционни ГИС методи: ръчна дигитализация или pixel-by-pixel класификация в ERDAS/ENVI отнема дни
- CNN сегментация: часа или минути за голяма територия

#### Визуален елемент
- **Изображение:** Тройка (или две) примери:
  - Ляво: сателитно изображение (RGB)
  - Дясно: резултат от семантична сегментация (различни цветове за различни класове: червено = град, зелено = гора, синьо = вода и т.н.)

---

# Архитектури за сегментация (U-Net и др.)

#### Encoder–Decoder парадигма
- **Encoder част:** CNN слоеве компресират входното изображение до по-нискоразмерно представяне
  - Целта: изваждане на високо ниво семантична информация (например "това е град")
  - Страната: губим пространствена разделителна способност
  
- **Decoder част:** операции като upsampling или transposed convolutions възстановяват пространствената разделителна способност
  - Целта: да предскажем клас за всеки оригинален пиксел
  - Проблем: декодерът сам по себе си "видя" низко ниво информация, детайлите се губят

#### U-Net архитектура (специален случай на encoder–decoder)
- **Skip connections:** Директни връзки от encoder към decoder на съответните нива
  - Позволяват комбиниране на высоко-нивелна семантика (от дълбоките encoder слоеве) с детайлна информация (от ранните encoder слоеве)
  - Резултат: много по-добра локализация на границите между класовете
  
- **Форма:** Диаграмата прилича на "U" (отодето и името)
- **Оригинално за:** медицински изображения; показало се отличното и за геопространствени данни
- **Предимство:** баланс между семантична точност и пространствена прецизност

#### Други архитектури (кратко)
- **DeepLab:** Използва atrous (dilated) convolutions и multi-scale контекст; по-мощна, но и по-сложна
- **SegNet:** Опростена версия на encoder–decoder; по-лека за развръщане

#### Личен избор за този проект
- Избрал си U-Net, защото е достатъчно мощна и по-лесна за имплементация vs DeepLab
- Показало се отлично на различни типове геопространствени данни

#### Визуален елемент
- **Изображение:** Архитектурна диаграма на U-Net (encoder с кръгчета и стрелки вляво, decoder вдясно, skip connections между тях, самата форма прилича на "U")

---

# Приложения в ГИС

#### Land Cover / Land Use (LULC) картиране
- Класификация на всеки пиксел в растер в категория (град, гора, селскостопанска земя, вода, паси и т.н.)
- Входни данни: Sentinel-2, Landsat, Copernicus
- Приложение: регионално/национално планиране, мониторинг на природните ресурси

#### Извличане на сгради и пътна мрежа
- Детекция и сегментация на линейни и площадни обекти
- Входни данни: висока резолюция сателитни изображения, дронови данни
- Предизвикателство: тесни пътища, дребни сгради; CNN се справя отлично

#### Картиране на растителност и водни обекти
- Разграничаване между различни типове растително покритие (лист. гора, иглолистна, храстител)
- Идентификация на водни тела (реки, езера, мочурища)
- Входни данни: мултиспектрални снимки (използване на IR каналите)

#### Мониторинг на промени във времето
- Обезлесяване: сравнение на LULC карти за различни периоди
- Урбанизация: наблюдение на разширяването на град
- Промени в крайбрежни зони: ерозия, промени на линията брег
- Метод: обучение на модел и последователно прилагане на временни серии от Sentinel

#### Визуален елемент
- **Изображение:** 2–3 примерни резултата:
  1. LULC карта (цветна растерна карта с различни цветове за различни класове)
  2. Извлечена пътна мрежа (бели линии на черна основа)
  3. Промени в растителност за два периода (две карти, например 2015 vs 2025)


---

# [Практическа част](https://github.com/PowerCell46/GithubPages/blob/main/Obsidian/SpatialAnalysisAndModeling/SatelliteImageClassification.ipynb)

#### Данни и начин на работа
- **Датасет:** (посочи конкретния датасет – напр. eurosat, ucmerced, или друг, ако знаеш)
- **Подход:** събиране на сателитни patch'и, разделяне на тренировъчен/тестов набор
- **Метод:** обучаване на модел за класификация (това е за patches; в бъдещото разширение може да е segmentation)

#### Технологичен стек
- **TensorFlow / Keras:** Framework за дълбоко обучение
- **Python библиотеки:**
  - **scikit-learn:** Метрики, preprocessing
  - **pandas:** Работа с таблици
  - **numpy:** Числени операции
  - **matplotlib:** Визуализация
  - **rasterio (в някои варианти):** Четене на растерни файлове
  - **hugging-face:** Трансфер лърнинг (достъп до предтренирани модели)

#### Какво правим с модела
1. **Дефинираме архитектура:** CNN с конволюционни слоеве, pooling, fully connected
2. **Обучаваме:** forward pass на примерите, калкулираме loss, backpropagation за коригиране на теглата
3. **Валидираме:** проверяваме точност на тестовия набор
4. **Предсказваме:** на нови сателитни patch'и

#### Резултати
- Точност на модела (accuracy, precision, recall)
- **Визуализация:** примерни predictions (input image → модел → предсказан клас)