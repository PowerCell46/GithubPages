class: center, middle

# Artificial neural networks

.center[
  <img src="./images/TitleSlideImage.png" alt="Title image"
       style="max-width:55%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

**Автор:** Петър Герджиков – Mid-level Software Engineer

---

# Programming VS Machine & Deep learning

#### Традиционно програмиране:
- Developer пише логика
- Детерминистично – същи входове = същи изходи
- Скалируемост: добра за определени сценарии, лоша при сложност

#### Machine Learning / Deep Learning:
- Модел **учи** от примери в данните
- Data-driven подход – правилата се издават автоматично
- Скалируемост: висока за повторяващи се задачи с големи дейтасети

---

## Use case-ове на изкуствен интелект от работа

OCR - Optical character recognition
- Разпознаване на ключови думи от фактури (контрагент, ЕГН, ЕИК, др.)

NLP - Natural language processor
- Извличане на ключови думи от имейл-сделка

LLM models, AI agents, etc.
- автоматизиране на задачи; консултация за подход при работа по даден тикет

.center[
  <img src="./images/OCR.png" alt="OCR"
       style="max-width:45%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# ИНМ в Геопространствения анализ

#### Предизвикателства в традиционния ГИС анализ:
- Класификация на сателитни изображения отнема часове ръчна работа
- Извличане на геопространствена информация от растери е деликатно и субективно
- Необходимост за различни подходи при различни мащабове и типове данни

#### Как ИНМ решават тези проблеми:
- **Автоматизация:** обучен модел класифицира за няколко минути, вместо часове
- **Обобщение:** един модел може да работи на различни мащабове
- **Точност:** често по-добра от традиционните методи при достатъчно данни

---

## Разпознаване на къщи по сателитно изображение

.center[
  <img src="https://a-us.storyblok.com/f/1018982/fd83270896/roof-condition-report-aerial-images.jpg/m/fit-in/1920x0/filters:quality(75)" alt="Programming vs AI"
       style="max-width:75%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# Какво е изкуствена невронна мрежа?

#### Основната идея
- Събираме **голям брой елементарни компоненти** (неврони)
- Всеки неврон получава входове, прилага претегляне и активация
- Когато комбинираме хиляди такива елементи, можем да научим <b>много сложни</b> зависимости между входове и изходи

#### Биологична аналогия
- Биологичен неврон получава сигнали (дендрити), обработва ги и изпраща нов сигнал 
- Изкуствен неврон работи по подобен начин, но с числа вместо електрохимични импулси

---

.center[
  <img src="./images/ArtificialNeuralNetwork.png" alt="Programming vs AI"
       style="max-width:85%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# Основни елементи на невронната мрежа

#### Основни компоненти
- **Входове (x₁, x₂, ...):** Данни от външния свят (например пиксели от изображение, текст)
- **Тегла (w₁, w₂, ...):** Параметри, които показват "колко важен" е всеки вход. Това е което моделът **учи**.
- **Bias (b):** Допълнителен параметър, който позволява гъвкаво изместване на решаващата граница.
- **Активационна функция f():** Прилага се след претегления сбор – позволява нелинейност.

#### Активационни функции
- **Sigmoid:** всички стойности между 0 и 1; проблем: малки градиенти при дълбоки мрежи
- **ReLU (Rectified Linear Unit):** Съвременен стандарт; максимум(0, x); бърза за обучение, стабилна

---

# Weights and Biases

.center[
  <img src="./images/neuron.png" alt="Programming vs AI"
       style="max-width:75%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# Обучение

- **Loss функция:** Измерва "колко лошо" предсказва моделът (сравнява предсказаното с реалното)
- **Gradient descent:** Алгоритъм, който намалява loss функцията чрез коригиране на теглата в правилната посока
- **Backpropagation:** Алгоритъм, който разпределя грешката назад през мрежата, за да се знае как да се променят теглата.

.center[
  <img src="./images/backpropagation.png" alt="Backpropagation"
       style="max-width:50%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# CNN за геопространствени данни

#### CNN (Convolutional Neural Networks)
- Вместо напълно свързани слоеве, използваме **конволюционни слоеве**
- Използваме малки матрици (kernels), които се движат по изображението
- Улавя **локални пространствени структури** много по-ефективно
- Намалява брой параметри → по-бързо обучение, по-добра генерализация

#### Защо CNN са перфектни за ГИС
- Растерни данни (сателитни, аерофото) са двумерни структури
- CNN естествено работи с локални зависимости в растерите
- Много по-ефективни от feedforward за растерни данни

---

.center[
  <img src="./images/CNN.png" alt="CNN"
       style="max-width:75%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]

---

# Приложение на CNN в ГИС

#### Защо CNN е подходящ за геопространствени данни?
- Растерни формати (GeoTIFF, COG) са природно двумерни матрици
- Локални признаци (текстури, ръбове) са критични за класификация земно покритие
- Модели обучени на един регион могат да работят на други региони

#### Ключови концепции:
- **Локални рецептивни полета:** Всеки неврон „вижда" само малък прозорец от изображението (например 3×3 пиксела)
- **Translation invariance:** Обект (сграда) се разпознава еднакво независимо от позицията
- **Йерархия на признаците:** Ранни слоеве → ръбове, средни → текстури, дълбоки → цели обекти

---

# CNN в практиката - Примери

#### Практическо приложение
- Класификация на сателитни 32×32 px patches в категории:
  - Град | Гора | Вода | Селскостопанска земя
- Всеки patch преминава през CNN и получава клас
	
#### Защо това работи?
- При обработка на сателитни сцени обектите са случайно разположени
- CNN обработва всяка локация еднакво (translation invariance)
- Улавя локални текстури и контрасти (граница град/поле, мрежа от дървета)


---

# Какво е семантична сегментация?

#### Определение
- **Семантична сегментация:** За всеки пиксел в изображението предсказваме съответстващия клас
- Резултат: **карта** (растер), при която всеки пиксел има лейбъл (например "град", "гора", "вода", "селскостопанска земя")

#### Сравнение с други задачи
- **Класификация на цялото изображение:** един клас за цялото изображение (например "урбанизирана територия") → не е достатъчно за ГИС
- **Object detection:** предсказва ограничителни правоъгълници (bounding boxes) и класове за отделни обекти (например "сграда в координати X") → полезно, но не дава пикселно разделение
- **Instance segmentation:** разделя пиксели по отделни обекти от един клас (например всяка отделна сграда отделно) → полезно за някои задачи, но сложно
- **Семантична сегментация:** всички пиксели от един клас са един обект, не важи от колко отделни сгради са съставени → идеално за LULC карти

#### Практическото значение
- Традиционни ГИС методи: ръчна дигитализация или pixel-by-pixel класификация в ERDAS/ENVI отнема дни
- CNN сегментация: часа или минути за голяма територия

#### Визуален елемент
- **Изображение:** Тройка (или две) примери:
  - Ляво: сателитно изображение (RGB)
  - Дясно: резултат от семантична сегментация (различни цветове за различни класове: червено = град, зелено = гора, синьо = вода и т.н.)

---

# Приложения в ГИС

#### Land Cover / Land Use (LULC) картиране
- Класификация на всеки пиксел в растер в категория (град, гора, селскостопанска земя, вода, паси и т.н.)
- Входни данни: Sentinel-2, Landsat, Copernicus
- Приложение: регионално/национално планиране, мониторинг на природните ресурси

#### Извличане на сгради и пътна мрежа
- Детекция и сегментация на линейни и площадни обекти
- Входни данни: висока резолюция сателитни изображения, дронови данни
- Предизвикателство: тесни пътища, дребни сгради; CNN се справя отлично

#### Картиране на растителност и водни обекти
- Разграничаване между различни типове растително покритие (лист. гора, иглолистна, храстител)
- Идентификация на водни тела (реки, езера, мочурища)
- Входни данни: мултиспектрални снимки (използване на IR каналите)

#### Мониторинг на промени във времето
- Обезлесяване: сравнение на LULC карти за различни периоди
- Урбанизация: наблюдение на разширяването на град
- Промени в крайбрежни зони: ерозия, промени на линията брег
- Метод: обучение на модел и последователно прилагане на временни серии от Sentinel

#### Визуален елемент
- **Изображение:** 2–3 примерни резултата:
  1. LULC карта (цветна растерна карта с различни цветове за различни класове)
  2. Извлечена пътна мрежа (бели линии на черна основа)
  3. Промени в растителност за два периода (две карти, например 2015 vs 2025)


---

# [Практическа част](https://github.com/PowerCell46/GithubPages/blob/main/Obsidian/SpatialAnalysisAndModeling/SatelliteImageClassification.ipynb)

#### Данни и начин на работа
- **Датасет:** `eurosat\rgb`
- **Метод:** обучаване на модел за класификация

#### Tech stack
- **TensorFlow / Keras:** Framework за deep learning
- **Python библиотеки:**
	- scikit-learn | pandas | numpy | matplotlib | rasterio | hugging-face

---

## Ще ни вземе ли AI-я хляба?

.center[
  <img src="./images/HumansVsAi.png" alt="CNN"
       style="max-width:75%; max-height:45vh; width:auto; height:auto; object-fit:contain; display:block; margin:0 auto;">
]
